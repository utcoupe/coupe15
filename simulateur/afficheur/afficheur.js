var data = '{
    
    "robots" : {

        "gr" : { "x": 0.3, "y": 0.3, "z": 0.3, "zrot": 0, "coul": "#ff0000"},
        "pr" : { "x": 0.3, "y": 0.3, "z": 0.3, "zrot": 0, "coul": "#ff0000"},
        "ge" : { "x": 0.3, "y": 0.3, "z": 0.3, "coul": "#ff0000"},
        "pe" : { "x": 0.3, "y": 0.3, "z": 0.3, "coul": "#ff0000"}
    },

    "ampoules" : [
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"}
    ],

    "clapets" : [
        {"x": 10,"y": 10,"z": 10,"zrot": 0, "coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"zrot": 0, "coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"zrot": 0, "coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"zrot": 0, "coul": "#ffff00"}
    ],

    "gobelets" : [
        {"x": 10,"y": 10,"z": 10, "coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10, "coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10, "coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10, "coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10, "coul": "#ffff00"}
    ],

    "pieds" : [
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"}
    ],

    "popcorns" : [
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#00ff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"},
        {"x": 10,"y": 10,"z": 10,"coul": "#ffff00"}
    ]


}';











RAYON_ENNEMIS_PETITS = 0.0875;
RAYON_ENNEMIS_GRANDS = 0.15;



//permet de redimensionner la fenetre
window.addEventListener('resize', function() {
    var WIDTH = window.innerWidth*1,
        HEIGHT = window.innerHeight*1;
    renderer.setSize(WIDTH, HEIGHT);
    camera.aspect = WIDTH / HEIGHT;
    camera.updateProjectionMatrix();
});

var container = document.getElementById("container");

var scene= new THREE.Scene();

var renderer = new THREE.WebGLRenderer({antialias:true});

renderer.setSize(window.innerWidth,window.innerHeight*1);
renderer.setClearColor(0x272525,0.5);
container.appendChild(renderer.domElement);

var camera = new THREE.PerspectiveCamera(75,window.innerWidth/window.innerHeight,0.1,1000);

camera.position.z = 3;
camera.position.y = 1;
camera.lookAt(camera.position);

//gere les controles de la camera
controls = new THREE.OrbitControls(camera, renderer.domElement);




//lights

var directionLight = new THREE.DirectionalLight(0xffffff,1);
directionLight.position.set(-2,5,-2);
directionLight.intensity = 0.5;
scene.add(directionLight);

var directionLight2 = new THREE.DirectionalLight(0xffffff,1);
directionLight2.position.set(-2,5,2);
directionLight.intensity2 = 0.5;
scene.add(directionLight2);

var directionLight3 = new THREE.DirectionalLight(0xffffff,1);
directionLight3.position.set(2,5,-2);
directionLight.intensity3 = 0.5;
scene.add(directionLight3);

var directionLight4 = new THREE.DirectionalLight(0xffffff,1);
directionLight4.position.set(2,5,2);
directionLight.intensity4 = 0.5;
scene.add(directionLight4);


var axisHelper = new THREE.AxisHelper( 5 ); scene.add( axisHelper );

//charge le plateau
var plateau;

var loader = new THREE.ColladaLoader();
loader.options.convertUpAxis = true;
loader.load('../3d/plateau_mieux.dae',function(collada){

    var dae = collada.scene;
    var skin = collada.skins[0];
   
    //rendre les cylindres transparents
    collada.dae.effects["transparent_003-effect"].shader.material.opacity = 0.2;
    collada.dae.effects["transparent_003-effect"].shader.material.transparent = true;
    plateau = collada;
    dae.position.set(0,0,0);
    dae.scale.set(1,1,1);
    scene.add(dae);


})



var data = JSON.parse(datatext);


function render(){


    requestAnimationFrame(render);
    renderer.render(scene,camera);
    controls.update();
}

render();














